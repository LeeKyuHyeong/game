<!-- 곡 신고 탭 콘텐츠 (프래그먼트) -->
<div class="report-tab-content" xmlns:th="http://www.thymeleaf.org">
    <div class="report-header">
        <span th:if="${pendingCount > 0}" class="pending-badge">
            대기 <span th:text="${pendingCount}"></span>건
        </span>
    </div>

    <div class="search-bar">
        <div class="filter-section">
            <select id="statusFilter">
                <option value="">전체 상태</option>
                <option value="PENDING" th:selected="${selectedStatus == 'PENDING'}">대기</option>
                <option value="CONFIRMED" th:selected="${selectedStatus == 'CONFIRMED'}">확인됨</option>
                <option value="REJECTED" th:selected="${selectedStatus == 'REJECTED'}">반려</option>
                <option value="RESOLVED" th:selected="${selectedStatus == 'RESOLVED'}">해결됨</option>
            </select>
            <a th:if="${selectedStatus}" href="#" class="btn btn-reset">필터 초기화</a>
        </div>
    </div>

    <div class="table-container">
        <table class="data-table">
            <thead>
            <tr>
                <th class="col-no">ID</th>
                <th>곡 정보</th>
                <th>신고 유형</th>
                <th>신고자</th>
                <th>상태</th>
                <th>신고일</th>
                <th>관리</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="report : ${reports}" onclick="toggleRowExpand(this)">
                <td data-label="ID" th:text="${report.id}"></td>
                <td data-label="곡 정보">
                    <div class="song-info-cell">
                        <span class="song-title" th:text="${report.song.title}"></span>
                        <span class="song-artist" th:text="${report.song.artist}"></span>
                    </div>
                </td>
                <td data-label="신고 유형">
                    <span class="report-type-badge"
                          th:classappend="${report.reportType.name()}"
                          th:text="${report.reportType.description}"></span>
                </td>
                <td data-label="신고자" th:text="${report.member != null} ? ${report.member.nickname} : '게스트'"></td>
                <td data-label="상태">
                    <span class="status-badge"
                          th:classappend="${report.status.name()}"
                          th:text="${report.status.description}"></span>
                </td>
                <td data-label="신고일" th:text="${#temporals.format(report.createdAt, 'yyyy-MM-dd HH:mm')}"></td>
                <td class="action-buttons" data-label="" onclick="event.stopPropagation()">
                    <button class="btn btn-sm btn-edit"
                            th:data-id="${report.id}"
                            th:data-song-title="${report.song.title}"
                            th:data-song-artist="${report.song.artist}"
                            th:data-report-type="${report.reportType.description}"
                            th:data-description="${report.description}"
                            th:data-status="${report.status.name()}"
                            onclick="openProcessModal(this)">처리</button>
                    <button th:if="${report.status.name() == 'CONFIRMED'}"
                            class="btn btn-sm btn-delete"
                            th:data-id="${report.id}"
                            onclick="disableSong(this.dataset.id)">곡 비활성화</button>
                </td>
            </tr>
            <tr th:if="${#lists.isEmpty(reports)}">
                <td colspan="7" class="empty-row">신고 내역이 없습니다.</td>
            </tr>
            </tbody>
        </table>
    </div>

    <div class="pagination" th:if="${totalPages > 0}">
        <a href="#" th:classappend="${currentPage == 0} ? 'disabled'" class="page-link" onclick="goToReportPage(0); return false;">«</a>
        <a href="#" th:classappend="${currentPage == 0} ? 'disabled'" class="page-link" th:onclick="'goToReportPage(' + ${currentPage - 1} + '); return false;'">‹</a>
        <th:block th:each="i : ${#numbers.sequence(0, totalPages - 1)}">
            <a th:if="${i >= currentPage - 2 and i <= currentPage + 2}" href="#" th:text="${i + 1}" th:classappend="${i == currentPage} ? 'active'" class="page-link" th:onclick="'goToReportPage(' + ${i} + '); return false;'"></a>
        </th:block>
        <a href="#" th:classappend="${currentPage >= totalPages - 1} ? 'disabled'" class="page-link" th:onclick="'goToReportPage(' + ${currentPage + 1} + '); return false;'">›</a>
        <a href="#" th:classappend="${currentPage >= totalPages - 1} ? 'disabled'" class="page-link" th:onclick="'goToReportPage(' + ${totalPages - 1} + '); return false;'">»</a>
    </div>
</div>

<style>
.report-header { display: flex; justify-content: flex-end; margin-bottom: 1rem; }
.pending-badge { background: #fef3c7; color: #92400e; padding: 0.5rem 1rem; border-radius: 0.5rem; font-weight: 600; }
.search-bar { margin-bottom: 1rem; }
.filter-section { display: flex; gap: 0.5rem; align-items: center; flex-wrap: wrap; }
.song-info-cell { display: flex; flex-direction: column; gap: 0.25rem; }
.song-info-cell .song-title { font-weight: 500; }
.song-info-cell .song-artist { font-size: 0.85rem; color: var(--text-secondary); }
.report-type-badge { padding: 0.25rem 0.5rem; border-radius: 0.25rem; font-size: 0.8rem; font-weight: 500; }
.report-type-badge.WRONG_ANSWER { background: #fee2e2; color: #991b1b; }
.report-type-badge.AUDIO_ISSUE { background: #fef3c7; color: #92400e; }
.report-type-badge.VIDEO_UNAVAILABLE { background: #dbeafe; color: #1e40af; }
.report-type-badge.COPYRIGHT { background: #ede9fe; color: #6d28d9; }
.report-type-badge.OTHER { background: #e5e7eb; color: #374151; }
.status-badge { padding: 0.25rem 0.5rem; border-radius: 0.25rem; font-size: 0.8rem; font-weight: 500; }
.status-badge.PENDING { background: #fef3c7; color: #92400e; }
.status-badge.CONFIRMED { background: #fee2e2; color: #991b1b; }
.status-badge.REJECTED { background: #e5e7eb; color: #374151; }
.status-badge.RESOLVED { background: #d1fae5; color: #065f46; }
@media (max-width: 768px) { .filter-section { flex-direction: column; } .filter-section select { width: 100%; } }
</style>
