<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{common/fragments/head :: adminHead('회원 관리')}"></head>
<body class="admin-page">
<link rel="stylesheet" th:href="@{/css/admin/table-mobile-collapse.css}">
<link rel="stylesheet" th:href="@{/css/admin/member-index.css}">
<div class="admin-container">
    <th:block th:replace="~{admin/layout/sidebar :: sidebar}"></th:block>

    <main class="main-content">
        <header class="content-header">
            <h1>회원 관리</h1>
        </header>

        <!-- 통합 통계 카드 -->
        <div class="stats-cards">
            <div class="stat-card">
                <div class="stat-value" th:text="${totalCount}">0</div>
                <div class="stat-label">전체 회원</div>
            </div>
            <div class="stat-card active">
                <div class="stat-value" th:text="${activeCount}">0</div>
                <div class="stat-label">활성 회원</div>
            </div>
            <div class="stat-card banned">
                <div class="stat-value" th:text="${bannedCount}">0</div>
                <div class="stat-label">정지 회원</div>
            </div>
            <div class="stat-card admin">
                <div class="stat-value" th:text="${adminCount}">0</div>
                <div class="stat-label">관리자</div>
            </div>
        </div>

        <!-- 탭 네비게이션 -->
        <div class="tab-navigation">
            <button class="tab-btn" th:classappend="${activeTab == 'member'} ? 'active'"
                    onclick="switchTab('member')">
                <span class="tab-icon">👥</span>
                <span class="tab-text">회원 목록</span>
            </button>
            <button class="tab-btn" th:classappend="${activeTab == 'login'} ? 'active'"
                    onclick="switchTab('login')">
                <span class="tab-icon">🔐</span>
                <span class="tab-text">로그인 이력</span>
            </button>
        </div>

        <!-- 탭 콘텐츠 -->
        <div class="tab-content" id="tabContent">
            <div class="loading-spinner">
                <div class="spinner"></div>
                <span>로딩 중...</span>
            </div>
        </div>
    </main>
</div>

<!-- 회원 상세 모달 -->
<div id="detailModal" class="modal">
    <div class="modal-content modal-md">
        <div class="modal-header">
            <h2>회원 상세 정보</h2>
            <button class="close-btn" onclick="closeModal('detailModal')">&times;</button>
        </div>
        <div class="modal-body" id="detailContent"></div>
        <div class="modal-footer">
            <button type="button" class="btn btn-warning" onclick="resetPassword()">비밀번호 초기화</button>
            <button type="button" class="btn btn-danger" onclick="kickSession()">세션 강제 종료</button>
            <button type="button" class="btn btn-cancel" onclick="closeModal('detailModal')">닫기</button>
        </div>
    </div>
</div>

<!-- 상태 변경 모달 -->
<div id="statusModal" class="modal">
    <div class="modal-content modal-sm">
        <div class="modal-header">
            <h2>회원 상태 변경</h2>
            <button class="close-btn" onclick="closeModal('statusModal')">&times;</button>
        </div>
        <form id="statusForm" class="modal-form">
            <input type="hidden" id="statusMemberId" name="id">
            <div class="form-group">
                <label>상태 선택</label>
                <div class="radio-group">
                    <label class="radio-label"><input type="radio" name="status" value="ACTIVE"> 활성</label>
                    <label class="radio-label"><input type="radio" name="status" value="INACTIVE"> 비활성</label>
                    <label class="radio-label"><input type="radio" name="status" value="BANNED"> 정지</label>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-cancel" onclick="closeModal('statusModal')">취소</button>
                <button type="submit" class="btn btn-primary">변경</button>
            </div>
        </form>
    </div>
</div>

<!-- 권한 변경 모달 -->
<div id="roleModal" class="modal">
    <div class="modal-content modal-sm">
        <div class="modal-header">
            <h2>회원 권한 변경</h2>
            <button class="close-btn" onclick="closeModal('roleModal')">&times;</button>
        </div>
        <form id="roleForm" class="modal-form">
            <input type="hidden" id="roleMemberId" name="id">
            <div class="form-group">
                <label>권한 선택</label>
                <div class="radio-group">
                    <label class="radio-label"><input type="radio" name="role" value="USER"> 일반 사용자</label>
                    <label class="radio-label"><input type="radio" name="role" value="ADMIN"> 관리자</label>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-cancel" onclick="closeModal('roleModal')">취소</button>
                <button type="submit" class="btn btn-primary">변경</button>
            </div>
        </form>
    </div>
</div>

<script th:src="@{/js/common/common.js}"></script>
<script th:src="@{/js/admin/admin-member-index.js}"></script>
<script th:inline="javascript">
    currentTab = [[${activeTab}]];
</script>
</body>
</html>
