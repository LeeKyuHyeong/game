<!-- ì•„í‹°ìŠ¤íŠ¸ë³„ í†µê³„ íƒ­ ì½˜í…ì¸  (í”„ë˜ê·¸ë¨¼íŠ¸) -->
<div class="popularity-tab-content" xmlns:th="http://www.thymeleaf.org">
    <!-- ì„œë¸Œ í†µê³„ -->
    <div class="sub-stats">
        <div class="sub-stat">
            <span class="sub-stat-value" th:text="${totalItems}">0</span>
            <span class="sub-stat-label">ì•„í‹°ìŠ¤íŠ¸ ìˆ˜</span>
        </div>
    </div>

    <!-- ê²€ìƒ‰ -->
    <div class="search-bar">
        <form class="search-form">
            <input type="text" name="keyword" th:value="${keyword}" placeholder="ì•„í‹°ìŠ¤íŠ¸ ê²€ìƒ‰">
            <button type="submit" class="btn btn-search">ê²€ìƒ‰</button>
            <a th:if="${keyword != null}" href="#" class="btn btn-reset" onclick="resetSearch()">ì´ˆê¸°í™”</a>
        </form>
    </div>

    <!-- í…Œì´ë¸” -->
    <div class="table-container">
        <table class="data-table sortable-table">
            <thead>
            <tr>
                <th class="col-no">No</th>
                <th class="sortable" th:classappend="${sort == 'artist'} ? ('sorted-' + ${direction})"
                    data-sort="artist">ì•„í‹°ìŠ¤íŠ¸ <span class="sort-icon"></span></th>
                <th class="sortable" th:classappend="${sort == 'songCount'} ? ('sorted-' + ${direction})"
                    data-sort="songCount">ê³¡ ìˆ˜ <span class="sort-icon"></span></th>
                <th class="sortable" th:classappend="${sort == 'avgRating'} ? ('sorted-' + ${direction})"
                    data-sort="avgRating">í‰ê·  í‰ì  <span class="sort-icon"></span></th>
                <th class="sortable" th:classappend="${sort == 'totalVotes'} ? ('sorted-' + ${direction})"
                    data-sort="totalVotes">ì´ íˆ¬í‘œ <span class="sort-icon"></span></th>
                <th>ëŒ€ì¤‘ì„± ë“±ê¸‰</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="stat, iterStat : ${artistStats}" onclick="toggleRowExpand(this)">
                <td data-label="No" th:text="${currentPage * size + iterStat.index + 1}"></td>
                <td data-label="ì•„í‹°ìŠ¤íŠ¸" th:text="${stat.artist}"></td>
                <td data-label="ê³¡ ìˆ˜" th:text="${stat.songCount}"></td>
                <td data-label="í‰ê·  í‰ì ">
                    <div class="rating-display">
                        <span class="rating-stars" th:attr="data-rating=${stat.avgRating}">
                            <span th:each="i : ${#numbers.sequence(1, 5)}"
                                  th:classappend="${i <= stat.avgRating} ? 'filled' : 'empty'"
                                  class="star">â˜…</span>
                        </span>
                        <span class="rating-value" th:text="${#numbers.formatDecimal(stat.avgRating, 1, 1)}"></span>
                    </div>
                </td>
                <td data-label="ì´ íˆ¬í‘œ" th:text="${stat.totalVotes}"></td>
                <td data-label="ëŒ€ì¤‘ì„± ë“±ê¸‰">
                    <span class="popularity-grade"
                          th:classappend="${stat.avgRating <= 1.5} ? 'very-popular' : (${stat.avgRating <= 2.5} ? 'popular' : (${stat.avgRating <= 3.5} ? 'normal' : (${stat.avgRating <= 4.5} ? 'maniac' : 'very-maniac')))">
                        <th:block th:if="${stat.avgRating <= 1.5}">ğŸŒŸ ë§¤ìš° ëŒ€ì¤‘ì </th:block>
                        <th:block th:if="${stat.avgRating > 1.5 and stat.avgRating <= 2.5}">â­ ëŒ€ì¤‘ì </th:block>
                        <th:block th:if="${stat.avgRating > 2.5 and stat.avgRating <= 3.5}">ğŸµ ë³´í†µ</th:block>
                        <th:block th:if="${stat.avgRating > 3.5 and stat.avgRating <= 4.5}">ğŸ¸ ë§¤ë‹ˆì•…</th:block>
                        <th:block th:if="${stat.avgRating > 4.5}">ğŸ’€ ë§¤ìš° ë§¤ë‹ˆì•…</th:block>
                    </span>
                </td>
            </tr>
            <tr th:if="${#lists.isEmpty(artistStats)}">
                <td colspan="6" class="empty-row">íˆ¬í‘œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</td>
            </tr>
            </tbody>
        </table>
    </div>

    <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
    <div class="pagination" th:if="${totalPages > 0}">
        <a href="#" th:classappend="${currentPage == 0} ? 'disabled'" class="page-link"
           th:onclick="'goToPage(0); return false;'">Â«</a>
        <a href="#" th:classappend="${currentPage == 0} ? 'disabled'" class="page-link"
           th:onclick="'goToPage(' + ${currentPage - 1} + '); return false;'">â€¹</a>

        <th:block th:each="i : ${#numbers.sequence(0, totalPages - 1)}">
            <a th:if="${i >= currentPage - 2 and i <= currentPage + 2}"
               href="#" th:text="${i + 1}"
               th:classappend="${i == currentPage} ? 'active'" class="page-link"
               th:onclick="'goToPage(' + ${i} + '); return false;'"></a>
        </th:block>

        <a href="#" th:classappend="${currentPage >= totalPages - 1} ? 'disabled'" class="page-link"
           th:onclick="'goToPage(' + ${currentPage + 1} + '); return false;'">â€º</a>
        <a href="#" th:classappend="${currentPage >= totalPages - 1} ? 'disabled'" class="page-link"
           th:onclick="'goToPage(' + ${totalPages - 1} + '); return false;'">Â»</a>
    </div>
</div>
