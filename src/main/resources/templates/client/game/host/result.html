<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{common/fragments/head :: clientHead('Í≤åÏûÑ Í≤∞Í≥º - Song Quiz')}"></head>
<body class="client-page result-page">
<div class="result-container">
    <header class="result-header">
        <h1>üèÜ Í≤åÏûÑ Í≤∞Í≥º</h1>
    </header>

    <main class="result-main">
        <!-- Îç∞Ïä§ÌÅ¨ÌÉë: Ìè¨ÎîîÏõÄ -->
        <div class="podium-section desktop-only" th:if="${#lists.size(playerScores) >= 1}">
            <div class="podium">
                <div class="podium-place second" th:if="${#lists.size(playerScores) >= 2}">
                    <div class="place-medal" th:text="${playerScores[1].rank == 1} ? 'ü•á' : (${playerScores[1].rank == 2} ? 'ü•à' : 'ü•â')"></div>
                    <div class="place-name" th:text="${playerScores[1].name}"></div>
                    <div class="place-score" th:text="${playerScores[1].score} + 'Ï†ê'"></div>
                    <div class="place-stand" th:text="${playerScores[1].rank}"></div>
                </div>
                <div class="podium-place first">
                    <div class="place-medal" th:text="${playerScores[0].rank == 1} ? 'ü•á' : (${playerScores[0].rank == 2} ? 'ü•à' : 'ü•â')"></div>
                    <div class="place-name" th:text="${playerScores[0].name}"></div>
                    <div class="place-score" th:text="${playerScores[0].score} + 'Ï†ê'"></div>
                    <div class="place-stand" th:text="${playerScores[0].rank}"></div>
                </div>
                <div class="podium-place third" th:if="${#lists.size(playerScores) >= 3}">
                    <div class="place-medal" th:text="${playerScores[2].rank == 1} ? 'ü•á' : (${playerScores[2].rank == 2} ? 'ü•à' : 'ü•â')"></div>
                    <div class="place-name" th:text="${playerScores[2].name}"></div>
                    <div class="place-score" th:text="${playerScores[2].score} + 'Ï†ê'"></div>
                    <div class="place-stand" th:text="${playerScores[2].rank}"></div>
                </div>
            </div>
        </div>

        <!-- Î™®Î∞îÏùº: Îû≠ÌÇπ Î¶¨Ïä§Ìä∏ -->
        <div class="ranking-list-section mobile-only" th:if="${#lists.size(playerScores) >= 1}">
            <div th:each="entry : ${playerScores}" class="ranking-row"
                 th:classappend="${entry.rank == 1} ? 'first' : (${entry.rank == 2} ? 'second' : (${entry.rank == 3} ? 'third' : ''))">
                <span class="rank-medal" th:text="${entry.rank == 1} ? 'ü•á' : (${entry.rank == 2} ? 'ü•à' : (${entry.rank == 3} ? 'ü•â' : ${entry.rank}))"></span>
                <span class="rank-name" th:text="${entry.name}"></span>
                <span class="rank-score" th:text="${entry.score} + 'Ï†ê'"></span>
            </div>
        </div>

        <div class="stats-bar">
            <div class="stat-item">
                <span class="stat-label">Ï†ïÎãµ</span>
                <span class="stat-value correct" th:text="${gameSession.correctCount}"></span>
            </div>
            <div class="stat-divider"></div>
            <div class="stat-item">
                <span class="stat-label">Ïä§ÌÇµ</span>
                <span class="stat-value skip" th:text="${gameSession.skipCount}"></span>
            </div>
            <div class="stat-divider"></div>
            <div class="stat-item">
                <span class="stat-label">Ï†ïÎãµÎ•†</span>
                <span class="stat-value" th:text="${gameSession.totalRounds > 0} ? ${#numbers.formatDecimal(gameSession.correctCount * 100.0 / gameSession.totalRounds, 1, 0)} + '%' : '0%'"></span>
            </div>
        </div>

        <div class="rounds-section">
            <h3>ÎùºÏö¥Îìú Í∏∞Î°ù</h3>
            <div class="rounds-grid">
                <div th:each="round : ${rounds}" class="round-card"
                     th:classappend="${round.status.name() == 'SKIPPED'} ? 'skipped' : 'answered'">
                    <div class="round-header">
                        <span class="round-num" th:text="'#' + ${round.roundNumber}"></span>
                        <span th:if="${round.status.name() == 'ANSWERED'}" class="round-status correct">Ï†ïÎãµ</span>
                        <span th:if="${round.status.name() == 'SKIPPED'}" class="round-status skip">Ïä§ÌÇµ</span>
                    </div>
                    <div class="round-body">
                        <div class="song-info">
                            <div class="song-title" th:text="${round.song != null} ? ${round.song.title} : '-'"></div>
                            <div class="song-artist" th:text="${round.song != null} ? ${round.song.artist} : ''"></div>
                        </div>
                        <div th:if="${round.status.name() == 'ANSWERED'}" class="winner-info">
                            <span class="winner-label">Ï†ïÎãµÏûê</span>
                            <span class="winner-name" th:text="${round.userAnswer}"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="all-scores desktop-only" th:if="${#lists.size(playerScores) > 3}">
            <h3>Ï†ÑÏ≤¥ ÏàúÏúÑ</h3>
            <div class="score-table">
                <div th:each="entry : ${playerScores}" class="score-row">
                    <span class="rank" th:text="${entry.rank} + 'ÏúÑ'"></span>
                    <span class="name" th:text="${entry.name}"></span>
                    <span class="score" th:text="${entry.score} + 'Ï†ê'"></span>
                </div>
            </div>
        </div>
    </main>

    <footer class="result-footer">
        <a href="/game/solo/host" class="btn btn-replay">Îã§Ïãú ÌïòÍ∏∞ üîÑ</a>
        <a href="/" class="btn btn-home">ÌôàÏúºÎ°ú üè†</a>
    </footer>
</div>

<script th:src="@{/js/common/common.js}"></script>
</body>
</html>