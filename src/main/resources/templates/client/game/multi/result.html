<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{common/fragments/head :: clientHead('ê²Œì„ ê²°ê³¼ - Song Quiz')}"></head>
<body class="client-page result-page">
<style>
    .tier-badge {
        display: inline-block;
        padding: 2px 8px;
        border-radius: 4px;
        font-size: 0.75rem;
        font-weight: bold;
        margin-right: 6px;
    }
    .lp-change {
        font-weight: bold;
        margin-left: 8px;
    }
    .lp-change.positive {
        color: #22c55e;
    }
    .lp-change.negative {
        color: #ef4444;
    }
    .lp-change.neutral {
        color: #6b7280;
    }
    .podium-tier {
        margin-top: 4px;
    }
    .podium-lp {
        font-size: 0.85rem;
        margin-top: 4px;
    }
    .player-tier-info {
        display: flex;
        align-items: center;
        gap: 4px;
    }
    .ranking-item {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 12px 16px;
        background: rgba(255,255,255,0.05);
        border-radius: 8px;
        margin-bottom: 8px;
    }
    .ranking-item.me {
        background: rgba(99, 102, 241, 0.2);
        border: 1px solid rgba(99, 102, 241, 0.4);
    }
    .player-info {
        display: flex;
        align-items: center;
        gap: 8px;
        flex: 1;
    }
    .stats-info {
        display: flex;
        align-items: center;
        gap: 16px;
    }
</style>

<div class="client-container">
    <header class="result-header">
        <div style="display: flex; justify-content: flex-end; padding: 8px;">
            <a href="/" class="btn-home">ğŸ  í™ˆ</a>
        </div>
        <h1>ğŸ† ê²Œì„ ì¢…ë£Œ!</h1>
        <p class="room-name" th:text="${room.roomName}">ë°© ì´ë¦„</p>
    </header>

    <main class="result-main">
        <div class="podium-section">
            <!-- 2ë“± -->
            <div class="podium-item second" th:if="${#lists.size(results) > 1}">
                <div class="podium-rank">ğŸ¥ˆ</div>
                <div class="podium-tier">
                    <span class="tier-badge" th:style="'background-color:' + ${results[1].multiTierColor} + '; color: #000;'"
                          th:text="${results[1].multiTierDisplayName}">ë¸Œë¡ ì¦ˆ</span>
                </div>
                <div class="podium-player second-name" th:text="${results[1].nickname}">2ë“±</div>
                <div class="podium-score" th:text="${results[1].score} + 'ì '">0ì </div>
                <div class="podium-lp">
                    <span class="lp-change"
                          th:classappend="${results[1].lpChange > 0} ? 'positive' : (${results[1].lpChange < 0} ? 'negative' : 'neutral')">
                        <span th:if="${results[1].lpChange > 0}">+</span><span th:text="${results[1].lpChange}">0</span> LP
                    </span>
                </div>
                <div class="podium-stand second-stand">2</div>
            </div>

            <!-- 1ë“± -->
            <div class="podium-item first" th:if="${#lists.size(results) > 0}">
                <div class="podium-crown">ğŸ‘‘</div>
                <div class="podium-rank">ğŸ¥‡</div>
                <div class="podium-tier">
                    <span class="tier-badge" th:style="'background-color:' + ${results[0].multiTierColor} + '; color: #000;'"
                          th:text="${results[0].multiTierDisplayName}">ë¸Œë¡ ì¦ˆ</span>
                </div>
                <div class="podium-player first-name" th:text="${results[0].nickname}">1ë“±</div>
                <div class="podium-score" th:text="${results[0].score} + 'ì '">0ì </div>
                <div class="podium-lp">
                    <span class="lp-change positive">
                        +<span th:text="${results[0].lpChange}">100</span> LP
                    </span>
                </div>
                <div class="podium-stand first-stand">1</div>
            </div>

            <!-- 3ë“± -->
            <div class="podium-item third" th:if="${#lists.size(results) > 2}">
                <div class="podium-rank">ğŸ¥‰</div>
                <div class="podium-tier">
                    <span class="tier-badge" th:style="'background-color:' + ${results[2].multiTierColor} + '; color: #000;'"
                          th:text="${results[2].multiTierDisplayName}">ë¸Œë¡ ì¦ˆ</span>
                </div>
                <div class="podium-player third-name" th:text="${results[2].nickname}">3ë“±</div>
                <div class="podium-score" th:text="${results[2].score} + 'ì '">0ì </div>
                <div class="podium-lp">
                    <span class="lp-change"
                          th:classappend="${results[2].lpChange > 0} ? 'positive' : (${results[2].lpChange < 0} ? 'negative' : 'neutral')">
                        <span th:if="${results[2].lpChange > 0}">+</span><span th:text="${results[2].lpChange}">0</span> LP
                    </span>
                </div>
                <div class="podium-stand third-stand">3</div>
            </div>
        </div>

        <!-- ì „ì²´ ìˆœìœ„ -->
        <div class="full-ranking">
            <h2>ğŸ“Š ì „ì²´ ìˆœìœ„</h2>
            <div class="ranking-list">
                <div th:each="r : ${results}" class="ranking-item"
                     th:classappend="${r.memberId == member.id} ? 'me' : ''">
                    <span class="rank" th:text="${r.rank}">1</span>
                    <div class="player-info">
                        <span class="tier-badge" th:style="'background-color:' + ${r.multiTierColor} + '; color: #000;'"
                              th:text="${r.multiTierDisplayName}">ë¸Œë¡ ì¦ˆ</span>
                        <span class="player-name">
                            <span th:if="${r.isHost}">ğŸ‘‘ </span>
                            <span th:text="${r.nickname}">ë‹‰ë„¤ì„</span>
                            <span th:if="${r.memberId == member.id}" class="me-badge">(ë‚˜)</span>
                        </span>
                    </div>
                    <div class="stats-info">
                        <span class="lp-change"
                              th:classappend="${r.lpChange > 0} ? 'positive' : (${r.lpChange < 0} ? 'negative' : 'neutral')">
                            <span th:if="${r.lpChange > 0}">+</span><span th:text="${r.lpChange}">0</span> LP
                        </span>
                        <span class="correct-count" th:text="'ì •ë‹µ ' + ${r.correctCount} + 'ê°œ'">ì •ë‹µ 0ê°œ</span>
                        <span class="total-score" th:text="${r.score} + 'ì '">0ì </span>
                    </div>
                </div>
            </div>
        </div>

        <div class="result-actions">
            <a href="/game/multi" class="btn btn-lobby">ë¡œë¹„ë¡œ ëŒì•„ê°€ê¸°</a>
        </div>
    </main>
</div>

<script th:src="@{/js/common/common.js}"></script>
</body>
</html>
