<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{common/fragments/head :: clientHead('아티스트 챌린지 - Song Quiz')}"></head>
<link rel="stylesheet" th:href="@{/css/client/setup.css}">
<link rel="stylesheet" th:href="@{/css/client/game-fan-challenge.css}">
<body class="client-page">
<div class="client-container">
    <header class="client-header compact">
        <nav class="header-nav">
            <a href="/" class="btn-home">🏠 홈</a>
        </nav>
        <h1>아티스트 챌린지</h1>
    </header>

    <main class="setup-main">
        <div class="setup-card fan-challenge-card">
            <div class="challenge-intro">
                <div class="challenge-icon">&#127942;</div>
                <h2>진정한 팬이라면 8초 안에!</h2>
                <p class="challenge-desc">
                    선택한 아티스트의 <strong>랜덤 20곡</strong>을 듣고 맞춰라!<br>
                    3번 틀리면 게임 오버!
                </p>
            </div>

            <div class="setup-step">
                <h3>닉네임</h3>
                <input type="text" id="nickname" class="input-text"
                       th:value="${nickname}" placeholder="닉네임을 입력하세요" maxlength="20">
            </div>

            <div class="setup-step">
                <h3>아티스트 선택</h3>

                <!-- 선택 전 상태: 검색창 + 인기 아티스트 목록 -->
                <div id="artistSelectArea" class="artist-select-area">
                    <div class="artist-search-container">
                        <input type="text" id="artistSearch" class="input-text"
                               placeholder="아티스트 검색...">
                        <div id="artistSearchResults" class="search-results"></div>
                    </div>

                    <div class="artist-list-container">
                        <h4>인기 아티스트</h4>
                        <div id="artistList" class="artist-list"></div>
                    </div>
                </div>

                <!-- 선택 완료 상태: 선택된 아티스트 강조 표시 -->
                <div id="selectedArtistArea" class="selected-artist-area" style="display: none;">
                    <div class="selected-artist-card">
                        <div class="selected-badge">&#10003; 선택 완료</div>
                        <div class="selected-artist-info">
                            <span class="selected-artist-icon">&#127908;</span>
                            <span id="selectedArtistName" class="selected-artist-name"></span>
                            <span id="selectedArtistCount" class="selected-artist-count"></span>
                        </div>
                        <button type="button" class="btn-change-artist" onclick="clearSelectedArtist()">
                            다른 아티스트 선택
                        </button>
                    </div>
                </div>
            </div>

            <div class="setup-step">
                <h3>난이도 선택</h3>
                <div class="difficulty-selector">
                    <button type="button" class="difficulty-btn selected" data-difficulty="NORMAL" onclick="selectDifficulty('NORMAL')">
                        <span class="diff-icon">&#11088;</span>
                        <span class="diff-name">노말</span>
                        <span class="diff-desc">듣기 7초 + 입력 6초 | 라이프 3개</span>
                        <span class="diff-badge practice">연습 모드</span>
                    </button>
                    <button type="button" class="difficulty-btn" data-difficulty="HARDCORE" onclick="selectDifficulty('HARDCORE')">
                        <span class="diff-icon">&#128293;</span>
                        <span class="diff-name">하드코어</span>
                        <span class="diff-desc">듣기 5초 + 입력 5초 | 라이프 3개</span>
                        <span class="diff-badge ranked">공식 랭킹</span>
                    </button>
                </div>
            </div>

            <div class="setup-step rules-section">
                <h3>게임 규칙</h3>
                <ul class="rules-list" id="rulesList">
                    <li><span class="rule-icon">&#127925;</span> 해당 아티스트의 <strong>랜덤 20곡</strong> 출제</li>
                    <li><span class="rule-icon">&#9200;</span> 노말: <strong>7초</strong> 듣기 | 하드코어: <strong>5초</strong> 듣기</li>
                    <li><span class="rule-icon">&#10084;</span> 라이프 <strong>3개</strong> (오답/시간초과 시 -1)</li>
                    <li><span class="rule-icon">&#128683;</span> 스킵 <strong>불가능</strong></li>
                    <li><span class="rule-icon">&#128221;</span> <strong>하드코어</strong>만 공식 랭킹 반영</li>
                </ul>
            </div>

            <div class="login-notice" th:if="${member == null}">
                <p>&#128274; 로그인하면 기록이 저장됩니다!</p>
                <a th:href="@{/auth/login}" class="btn-login-link">로그인하기</a>
            </div>

            <button type="button" id="startBtn" class="btn-start" onclick="startGame()">
                도전 시작!
            </button>
        </div>
    </main>
</div>

<script th:inline="javascript">
    const memberNickname = [[${nickname}]];
</script>
<script th:src="@{/js/client/game-fan-challenge-setup.js}"></script>
</body>
</html>
