# TODO

## 2026-01-22 변경 내역

### 관리자 메뉴 통합
- [O] 챌린지 관리 통합 (팬 챌린지 + 장르 챌린지 → 탭 기반 UI)
- [O] 멀티게임 관리 통합 (방 관리 + 채팅 이력 → 탭 기반 UI)
- [O] 회원 관리 통합 (회원 목록 + 로그인 이력 → 탭 기반 UI)
- [O] 게임 관리 통합 (게임 이력 + 랭킹 → 탭 기반 UI)
- [O] 노래 관리 통합 (노래 목록 + 곡 신고 → 탭 기반 UI)
- [O] 사이드바 메뉴 16개 → 11개로 축소 (31% 감소)

### 버그 수정
- [O] 장르챌린지 상세 모달이 열리지 않는 버그 수정 (CSS 클래스 'active' → 'show' 변경)

---

## 2026-01-20 변경 내역

### 기능 구현
- [O] 랭킹 페이지 6개 탭 추가 (멀티 티어 / 주간 멀티 / 30곡 챌린지 / 레트로 / 팬 챌린지 / 통계)
- [O] 레트로 랭킹 API 추가 (/api/ranking?mode=retro) - 누적 점수, 30곡 최고점, 주간
- [O] 팬 챌린지 글로벌 랭킹 API 추가 (/api/ranking/fan-challenge) - 퍼펙트 클리어 횟수, 도전 아티스트 수
- [O] FanChallengeRecordRepository 글로벌 랭킹 쿼리 추가

### UI/UX 개선
- [O] 랭킹 페이지 6탭 반응형 레이아웃 (PC: 6열, 태블릿: 3열, 모바일: 2열)
- [O] 각 탭별 서브탭 및 안내 문구 추가

---

## 2026-01-19 변경 내역

### 기능 구현
- [O] 아티스트 챌린지 정보 API 추가 (설정 화면용 - 1위 기록, 내 기록)
- [O] Fan Challenge 기록 저장 로직 개선 (모든 점수에 시간 기록, 동점 시간 갱신)
- [O] 세션 조회 Lazy Loading 문제 해결 (rounds/song JOIN FETCH)
- [O] 관리자용 FanChallengeRecord 쿼리 메서드 추가
- [O] WeeklyPerfectRefreshBatch 배치 등록 (주간 퍼펙트 상태 갱신)
- [O] 팬 챌린지 관리자 페이지 추가 (AdminFanChallengeController)

### UI/UX 개선
- [O] 홈 화면 모바일 햄버거 메뉴 추가 (슬라이드 네비게이션)
- [O] 그리드 체커보드 패턴 자동 적용 (열 수 자동 감지)
- [O] 게임 화면 모바일 플로팅 버튼 추가 (홈/포기)
- [O] 모바일 아티스트 유형 선택 버튼화 (select → buttons)
- [O] 정답 모달 스킵 시 메시지 표시
- [O] Admin/Client CSS 테마 변수화 (다크모드 대응)
- [O] 모바일 반응형 레이아웃 개선 (setup, result, play 화면)
- [O] rem 단위 및 CSS 변수 표준화
- [O] 라이트모드 전체랭킹 포디움 내부 별명 및 점수 color
- [] 통계 가시성 Up
- [] 커뮤니티 모바일 버전 탭 디자인 수정 
- [O] 아티스트 챌린지 정답 가시성
- 
### 테스트
- [O] FanChallengeServiceTest 추가
- [O] AdminFanChallengeControllerTest 추가
- [O] WeeklyPerfectRefreshBatchTest 추가

---

## 2026-01-15 (20시 이후) 변경 내역

### 기능 구현
- [O] 아티스트 챌린지 개편: 30곡 고정 포맷, 난이도 단순화
- [O] 호스트 모드 2라운드부터 자동 재생 기능
- [O] 내가맞추기 모드 다음 라운드 자동 재생 기능
- [O] 멀티플레이어 대기실 강퇴 감지 기능
- [O] 멀티플레이어 게임 헤더에 내 점수 표시
- [ ] 2000년대 이전 노래 목록으로 레트로 게임 유형 만들기 

### UI/UX 개선
- [O] 통계 페이지 벤토 그리드 레이아웃 적용
- [O] 아티스트 챌린지 랭킹 PC 드래그 스크롤 지원
- [O] 게임 UI 통일화 (music-controls-bar 컴포넌트)
- [O] 관리자 페이지 헤더 이모지 제거
- [O] 게임 이력 상세 페이지 UI 개선 (목록 버튼화, 힌트 컬럼 제거)
- [O] 라이트/다크 테마 토글 기능

### 테스트
- [O] 30곡 고정 아티스트 챌린지 테스트 업데이트

---

## 기능 구현

### 자동 재생 기능
- [O] '게임 진행' 다음 라운드 노래 자동 재생 기능 구현
- [O] '내가맞추기' 다음 라운드 노래 자동 재생 기능 구현
- [O] '멀티게임' 다음 라운드 노래 자동 재생 기능 구현

### 콘텐츠 관리
- [ ] 아티스트 챌린지 기능 변경

---

## UI/UX 개선 작업

### 통계 페이지
- [O] 로그인 후 통계 - 내 기록 design 확인

### 아티스트 챌린지
- [O] 랭킹 목록 PC화면 드래그 안됨 수정

### 랭킹 페이지
- [O] 전체 랭킹 상단 탭 design 다시 확인

### 버튼 통일
- [O] 멀티게임 방 만들 때 '로비로' 버튼 -> '홈'과 동일하게 변경
- [O] 커뮤니티 디테일에서 '목록으로' 버튼 -> '홈'과 동일하게 변경


[O] 곡신고에서  상태변경 버튼이 안먹힘
[O] 랭킹화면 리뉴얼(client) - 6탭 구성 완료
[O] 아티스트 챌린지 결과화면에서 진행한 곡의 '대중성' / '매니악' 투표(번호 선택 1~5) 가능하게 팝업 + 투표 버튼 추가 (로그인 ID로 체크할지 그냥 매번 cnt올릴지)
[O] 관리자의 노래관리 목록에는 해당 아티스트옆의 숫자는 전체곡을 나타내야될거같아(이게 client쪽 게임 진행할때 뜨는 아티스트 목록의 노래개수에는 영향주면안됨)
[O] 장르 챌린지 추가 구현
[O] 관리자화면 메뉴 통합 가능한 곳 통합하기
[O] css 다크/라이트 가시성, 밝기 전체확인
[O] 노래 관리 화면 검색 파라미터 유지하기
[O] 관리자 랭킹 '팬챌린지' 오류 - tymeleaf 문법 오류일듯
[O] 사용자 관리 접근안됐음
[O] client 쪽 아티스트 챌린지 랭킹 보여줄때, score 높은 순서로 보여줘야겠음
[O] 사용자 관리 에서 게임 수 는 뭐로 - 전체게임
[O] 아티스트 챌린지 결과에서 투표한 대중성 정도 볼 수 있는 관리자화면 필요
[O] 유튜브 및 노래 중복 배치 후 변경된 목록 볼 수 있는 관리자화면 필요
[O] 메인화면 아티스트챌린지 TOP 목록 10명만 나오던 기능 수정 > 다 나오게
[O] 메인화면 장르챌린지 TOP 목록 추가
[] 관리자 메뉴 정리 12개>6개 메뉴 통합 (탭으로 관리)(미완)
[] 관리자 랭킹화면 css 및 소스확인 필요
[] 뱃지관리는 어디서?
[] 장르챌린지 유형 수정? 약 1000곡 로딩 넘 오래걸린다고 하는 사용자 피드백


---

## 2026-01-28 관리자 화면 전체 버튼 기능 테스트 (Playwright MCP)

### 테스트 환경
- URL: http://localhost:8082
- 계정: a@a.com / 123!@# (관리자)

### 1. 콘텐츠 관리 (/admin/content) ✅ 완료

#### 노래 관리 탭 (tab=song)
- [O] 검색 버튼 - 정상
- [O] + 노래 추가 - 모달 정상 (제목, 아티스트, YouTube URL, 시작/재생 시간, 장르, 발매연도, 솔로여부, 대중곡, 사용여부)
- [O] 수정 - 기존 데이터 채워진 모달 정상
- [O] 상태변경 - 미사용↔사용 토글 즉시 반영
- [O] ☰ 테이블 뷰 / ▦ 그리드 뷰 전환 - 정상
- [ ] 매니악/대중곡 버튼 - 미테스트
- [ ] 삭제 버튼 - 미테스트 (데이터 보존)
- [ ] 페이지네이션 - 미테스트
- [ ] 아티스트 필터 체크박스 - 미테스트
- [ ] 정렬 (ID, 제목, 아티스트, 연도, 등록일) - 미테스트

#### 정답 관리 탭 (tab=answer)
- [O] 탭 전환 - 정상
- [O] 검색/초기화 - 정상
- [X] **🚨 BUG: 정답 관리 버튼** - `ReferenceError: openAnswerModal is not defined`
- [ ] 상태변경 - 미테스트

#### 장르 관리 탭 (tab=genre)
- [O] 탭 전환 - 정상
- [O] 수정 - 장르 수정 모달 정상 (코드, 장르명, 정렬순서, 사용여부)
- [ ] + 장르 추가 - 미테스트
- [ ] 상태변경 - 미테스트
- [ ] 삭제 - 미테스트

#### 대중성 투표 탭 (tab=popularity)
- [O] 탭 전환 - 정상 (곡별 통계, 평균 평점, 분포 차트)
- [O] 상세 버튼 - 투표 상세 모달 정상 (회원, 평점, 평가, 투표일)
- [ ] 아티스트별 통계 서브탭 - 미테스트
- [ ] 투표 내역 서브탭 - 미테스트

#### 곡 신고 탭 (tab=report)
- [O] 탭 전환 - 정상 (대기 2건 표시)
- [ ] 처리 버튼 - 미테스트
- [ ] 상태 필터 - 미테스트

### 2. 게임 관리 (/admin/game) ❌ 500 에러

- [X] **🚨 BUG: 페이지 500 Server Error** - `NullPointerException` (아래 BUG-003 참조)
- [ ] 게임 이력 > 상세 링크 - 미테스트 (500 에러로 접근 불가)
- [ ] 게임 이력 > 삭제 버튼 - 미테스트 (500 에러로 접근 불가)
- [ ] 멀티 운영 탭 전환 - 미테스트 (500 에러로 접근 불가)
- [ ] 챌린지 기록 탭 - 미테스트 (500 에러로 접근 불가)

### 3. 회원 관리 (/admin/member) ✅ 완료

#### 회원 목록 탭
- [O] 페이지 로딩 - 정상 (3개 탭, 회원 20건 표시)
- [O] 탭: 회원 목록 - 정상 전환
- [O] 탭: 로그인 이력 - 정상 전환
- [O] 탭: 비속어 필터 - 정상 전환 (금칙어 관리가 여기에 위치)
- [O] 검색 (keyword) - "admin" 검색 시 1건 정상 반환
- [O] 검색 초기화 - 정상
- [O] 상세 모달 - 회원 상세 정보 모달 정상 (ID, 이메일, 별명, 권한)
- [O] 상태변경 모달 - 정상
- [O] 권한변경 모달 - 정상

### 4. 랭킹 관리 (/admin/ranking) ✅ 완료

- [O] 페이지 로딩 - 정상 (5개 탭)
- [O] 탭: 멀티 랭킹 - 정상 (6건)
- [O] 탭: 30곡 챌린지 랭킹 - 정상 (1건)
- [O] 탭: 아티스트 챌린지 랭킹 - 정상 (1건)
- [O] 탭: 장르 챌린지 랭킹 - 정상 (2건)
- [O] 탭: 레트로 챌린지 랭킹 - 정상 (3건)
- [O] 상세 버튼 - 회원 랭킹 상세 모달 정상
- [N/A] 기간별 필터 - 해당 기능 없음
- [N/A] 랭킹 리셋 버튼 - 해당 기능 없음

### 5. 통계 분석 (/admin/stats) ✅ 완료

- [O] 페이지 로딩 - 정상 (2개 1차 탭, 6개 통계 카드)
- [O] 1차 탭: 오답 통계 - 정상
- [O] 2차 탭: 자주 틀리는 답변 - 정상
- [O] 2차 탭: 어려운 곡 TOP - 정상
- [O] 2차 탭: 최근 오답 - 정상
- [O] 1차 탭: 대중성 통계 - 정상
- [O] 2차 탭: 검토 필요 - 정상
- [O] 2차 탭: 전체 통계 - 정상
- [O] 2차 탭: 필터링된 오답 - 정상
- [O] 기간 필터 (minPlays 셀렉트) - 정상
- [ ] 차트 표시 - 차트 없음 (데이터 테이블 방식 사용)

### 6. 시스템 설정 (/admin/system) ✅ 완료

- [O] 페이지 로딩 - 정상 (2개 탭: 배치 관리, 메뉴 관리)
- [O] 탭: 배치 관리 - 정상 전환
- [O] 탭: 메뉴 관리 - 정상 전환
- [O] 배치 실행 버튼 - 26개 실행 버튼 확인
- [O] 배치 활성/비활성 토글 - 25개 토글 버튼 정상
- [O] 전체 수동 실행 - 확인 다이얼로그 및 실행 모달 정상
- [O] 배치 상세 모달 - 정상
- [O] 메뉴 설정 저장 - 정상
- [ ] 배치 설정 모달 - 미테스트 (모달 중첩 이슈)
- **참고**: 금칙어 관리는 시스템 설정이 아닌 회원 관리 > 비속어 필터 탭에 위치

### 공통 UI ✅ 완료

- [O] 테마 전환 (라이트→다크) - `data-theme` 정상 변경
- [O] 테마 전환 (다크→라이트) - 정상 복원
- [O] 사이드바 접기 - expanded→collapsed 정상
- [O] 사이드바 펼치기 - collapsed→expanded 정상
- [O] 🏠 홈으로 - `/`로 정상 이동
- [O] 🚪 로그아웃 - `/admin/login`으로 정상 리다이렉트

### 🚨 발견된 버그

#### BUG-001: 정답 관리 > 정답 관리 버튼 미작동
- **위치**: 콘텐츠 관리 > 정답 관리 탭 > 각 행의 "정답 관리" 버튼
- **에러**: `ReferenceError: openAnswerModal is not defined`
- **원인**: `onclick="openAnswerModal(this)"` 호출하지만 해당 함수가 정의되지 않음
- **심각도**: 높음 (정답 관리 핵심 기능 불가)

#### BUG-002 (잠재): 게임 관리 > 멀티 운영 탭 전환 안 됨
- **위치**: 게임 관리 > 멀티 운영 탭 버튼
- **증상**: 클릭해도 게임 이력 탭 내용이 그대로 유지
- **심각도**: 중간 (BUG-003 수정 후 재확인 필요)

#### BUG-003: 게임 관리 페이지 500 Server Error (CRITICAL)
- **위치**: `AdminGameManagementController.java` line 47
- **에러**: `NullPointerException: Cannot invoke "java.lang.Double.doubleValue()"` - `gameSessionService.getAverageScore()` 반환값이 null
- **원인**: 게임 세션이 없을 때 `getAverageScore()`가 `null`을 반환하는데, primitive `double`에 할당하면서 auto-unboxing NPE 발생
- **수정 방안**: `Double avgScore = gameSessionService.getAverageScore();` + null 처리, 또는 서비스에서 `0.0` 기본값 반환
- **심각도**: 치명적 (게임 관리 페이지 전체 접근 불가)
- 
- 금칙어 관리는 시스템 설정이 아닌 회원 관리 > 비속어 필터 탭에 위치
- 랭킹 리셋/기간 필터 버튼은 현재 페이지에 존재하지 않음    